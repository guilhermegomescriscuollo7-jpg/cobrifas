<!DOCTYPE html>
<html lang="pt-br">
<head>
    <base target="_self">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha Conta | COBRIFAS</title>
    <meta name="description" content="√Årea exclusiva de membros COBRIFAS - Participe de sorteios de skins de Counter-Strike 2">
    
    <!-- Fontes -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "primary": "#ffcc00",
                        "bg-dark": "#050505",
                        "card-bg": "#0f0f0f",
                        "glass": "rgba(20, 20, 20, 0.95)",
                        "danger": "#ff4444",
                        "success": "#00ff66",
                        "silver": "#c0c0c0",
                        "bronze": "#cd7f32"
                    },
                    fontFamily: {
                        "orbitron": ["Orbitron", "sans-serif"],
                        "rajdhani": ["Rajdhani", "sans-serif"]
                    },
                    backgroundImage: {
                        "gradient-radial": "radial-gradient(var(--tw-gradient-stops))",
                        "pattern": "url('https://images8.alphacoders.com/132/1328325.png')"
                    },
                    animation: {
                        "ticker": "ticker 40s linear infinite",
                        "fade-in": "fadeIn 0.5s ease",
                        "pop-in": "popIn 0.5s ease",
                        "float": "float 2s infinite ease-in-out"
                    },
                    keyframes: {
                        ticker: {
                            "0%": { transform: "translate3d(0, 0, 0)" },
                            "100%": { transform: "translate3d(-100%, 0, 0)" }
                        },
                        fadeIn: {
                            "from": { opacity: "0", transform: "translateY(10px)" },
                            "to": { opacity: "1", transform: "translateY(0)" }
                        },
                        popIn: {
                            "from": { transform: "scale(0.5)", opacity: "0" },
                            "to": { transform: "scale(1)", opacity: "1" }
                        },
                        float: {
                            "0%, 100%": { transform: "translateY(0)" },
                            "50%": { transform: "translateY(-15px)" }
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #050505;
            background-image: radial-gradient(circle at 50% 10%, rgba(255, 204, 0, 0.05) 0%, transparent 50%),
                url('https://images8.alphacoders.com/132/1328325.png');
            background-attachment: fixed;
            background-size: cover;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Scrollbar personalizada */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 204, 0, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 204, 0, 0.5);
        }

        /* Overlay para modais */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 4000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        /* Anima√ß√µes */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="font-rajdhani bg-bg-dark text-white min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-black/90 backdrop-blur-md border-b-2 border-primary py-4 px-8 flex justify-between items-center">
        <a href="index.html" class="font-orbitron text-2xl font-black text-white no-underline">
            COB<span class="text-primary drop-shadow-[0_0_10px_rgba(255,204,0,0.5)]">RIFAS</span>
        </a>
        
        <nav class="flex items-center gap-2">
            <button onclick="openTab(event, 'loja')" class="font-orbitron font-bold text-xs uppercase py-2 px-4 rounded border border-transparent text-gray-400 hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all duration-400 active" data-tab="loja">
                Loja de Rifas
            </button>
            <button onclick="openTab(event, 'minhas')" class="font-orbitron font-bold text-xs uppercase py-2 px-4 rounded border border-transparent text-gray-400 hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all duration-400" data-tab="minhas">
                Minhas Rifas
            </button>
            <button onclick="openTab(event, 'suporte')" class="font-orbitron font-bold text-xs uppercase py-2 px-4 rounded border border-transparent text-gray-400 hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all duration-400" data-tab="suporte">
                Suporte Online
            </button>
            <button onclick="openTab(event, 'perfil')" class="font-orbitron font-bold text-xs uppercase py-2 px-4 rounded border border-transparent text-gray-400 hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all duration-400" data-tab="perfil">
                Editar Perfil
            </button>
            
            <button onclick="toggleCart()" class="relative ml-4 text-primary text-xl cursor-pointer flex items-center">
                <i class="fas fa-shopping-cart"></i>
                <span id="cartCount" class="absolute -top-2 -right-2 bg-danger text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center">0</span>
            </button>
            
            <button onclick="openTab(event, 'perfil')" class="ml-4 flex items-center gap-3 cursor-pointer">
                <img id="headAvatar" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Avatar do usu√°rio" class="w-10 h-10 rounded-full border-2 border-primary object-cover shadow-[0_0_10px_rgba(255,204,0,0.3)]">
                <span id="headName" class="font-orbitron text-primary font-black text-sm uppercase">Usu√°rio</span>
            </button>
            
            <button onclick="logout()" class="ml-4 border border-danger text-danger py-2 px-6 font-orbitron font-bold text-xs rounded cursor-pointer hover:bg-danger hover:text-white transition-all duration-300">
                SAIR
            </button>
        </nav>
    </header>

    <!-- Ticker -->
    <div class="w-full overflow-hidden bg-black/80 border-b border-gray-800 h-10 flex items-center">
        <div class="inline-block whitespace-nowrap pr-full animate-ticker" id="tickerContainer">
            <span class="inline-block px-8 text-sm text-gray-300 font-orbitron">üöÄ NOVOS SORTEIOS DISPON√çVEIS</span>
            <span class="inline-block px-8 text-sm text-gray-300 font-orbitron">üèÜ √öLTIMO GANHADOR: JO√ÉO S. - SKIN AK-47 REDLINE</span>
            <span class="inline-block px-8 text-sm text-gray-300 font-orbitron">‚ö° PAGAMENTOS VIA PIX - APROVA√á√ÉO R√ÅPIDA</span>
            <span class="inline-block px-8 text-sm text-gray-300 font-orbitron">üîí PLATAFORMA 100% SEGURA</span>
        </div>
    </div>

    <!-- Sidebar do Carrinho -->
    <div id="cartSidebar" class="fixed top-0 right-0 h-full w-96 bg-glass border-l-2 border-primary z-50 p-8 transition-all duration-500 -translate-x-full flex flex-col backdrop-blur-lg">
        <div class="flex justify-between items-center mb-8 font-orbitron">
            <h3 class="text-xl text-white">CARRINHO</h3>
            <button onclick="toggleCart()" class="text-gray-400 hover:text-white cursor-pointer transition-colors">
                <i class="fas fa-times mr-2"></i>FECHAR
            </button>
        </div>
        
        <div id="cartItemsList" class="flex-1 overflow-y-auto mb-6"></div>
        
        <div class="pt-6 border-t border-primary">
            <div class="flex justify-between mb-6 font-orbitron">
                <span class="text-gray-300">TOTAL:</span>
                <span id="cartTotalPrice" class="text-primary text-xl font-bold">R$ 0.00</span>
            </div>
            <button onclick="finalizarPedido()" class="w-full bg-primary text-black py-3 font-orbitron font-black uppercase rounded border-none cursor-pointer hover:brightness-110 transition-all duration-300">
                FINALIZAR PEDIDO (PIX)
            </button>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="py-20 px-8 text-center">
        <h1 class="font-orbitron font-black italic uppercase text-4xl md:text-6xl lg:text-7xl mb-4">
            SUA PR√ìXIMA <span class="text-primary block mt-2">SKIN DE ELITE</span>
        </h1>
        <p class="text-gray-400 text-lg max-w-2xl mx-auto">
            Participe de sorteios r√°pidos e seguros com as melhores skins de Counter-Strike 2.
        </p>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-8 py-8">
        <!-- Loja de Rifas -->
        <section id="loja" class="tab-content active animate-fade-in">
            <h2 class="font-orbitron text-2xl uppercase mb-10 flex items-center gap-4">
                <i class="fas fa-store text-primary"></i> VITRINE DE SKINS
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16" id="gridLoja"></div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mt-16">
                <!-- Ganhadores Recentes -->
                <div class="bg-glass border border-white/5 rounded-xl p-8">
                    <div class="font-orbitron text-lg text-white uppercase mb-8 pb-4 border-b border-white/5 flex items-center gap-3">
                        <i class="fas fa-trophy text-success"></i> GANHADORES RECENTES
                    </div>
                    <div id="recentWinnersList" class="space-y-3"></div>
                </div>
                
                <!-- Top Membros -->
                <div class="bg-glass border border-white/5 rounded-xl p-8">
                    <div class="font-orbitron text-lg text-white uppercase mb-8 pb-4 border-b border-white/5 flex items-center gap-3">
                        <i class="fas fa-crown text-primary"></i> TOP MEMBROS
                    </div>
                    <div id="globalRankingList" class="space-y-3"></div>
                </div>
            </div>
        </section>

        <!-- Minhas Rifas -->
        <section id="minhas" class="tab-content hidden">
            <h2 class="font-orbitron text-2xl uppercase mb-10 flex items-center gap-4">
                <i class="fas fa-ticket-alt text-primary"></i> MINHAS PARTICIPA√á√ïES
            </h2>
            
            <div class="bg-glass border border-white/5 rounded-xl p-8">
                <div id="listaParticipacoes" class="space-y-6"></div>
            </div>
        </section>

        <!-- Suporte Online -->
        <section id="suporte" class="tab-content hidden">
            <h2 class="font-orbitron text-2xl uppercase mb-10 flex items-center gap-4">
                <i class="fas fa-headset text-primary"></i> CHAT DE SUPORTE
            </h2>
            
            <div class="bg-glass border border-white/5 rounded-xl p-8">
                <div id="chatBox" class="h-96 overflow-y-auto mb-6 flex flex-col gap-4 p-4 bg-black/20 rounded-lg"></div>
                
                <div class="flex gap-4">
                    <input type="text" id="msgInput" placeholder="Digite sua d√∫vida..." class="flex-1 bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    <button onclick="enviarMsg()" class="bg-primary text-black font-orbitron font-bold uppercase py-3 px-8 rounded border-none cursor-pointer hover:brightness-110 transition-all">
                        ENVIAR
                    </button>
                </div>
            </div>
        </section>

        <!-- Editar Perfil -->
        <section id="perfil" class="tab-content hidden">
            <h2 class="font-orbitron text-2xl uppercase mb-10 flex items-center gap-4">
                <i class="fas fa-user-edit text-primary"></i> MEU PERFIL
            </h2>
            
            <div class="bg-glass border border-white/5 rounded-xl p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">NOME COMPLETO</label>
                        <input type="text" id="editNome" class="w-full bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    </div>
                    
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">NICK (APELIDO)</label>
                        <input type="text" id="editNick" class="w-full bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    </div>
                    
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">TELEFONE</label>
                        <input type="text" id="editTel" class="w-full bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    </div>
                    
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">CPF</label>
                        <input type="text" id="dispCpf" disabled class="w-full bg-black/40 border border-gray-800 text-white py-3 px-4 rounded opacity-60">
                    </div>
                    
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">NOVA SENHA</label>
                        <input type="password" id="editPass" class="w-full bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    </div>
                    
                    <div>
                        <label class="font-orbitron text-primary text-xs uppercase block mb-3">CONFIRMAR SENHA</label>
                        <input type="password" id="editConfirm" class="w-full bg-black border border-gray-800 text-white py-3 px-4 rounded focus:outline-none focus:border-primary transition-colors">
                    </div>
                </div>
                
                <div class="mb-10">
                    <label class="font-orbitron text-primary text-xs uppercase block mb-4">ESCOLHA SEU √çCONE:</label>
                    <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-4" id="avatarGrid"></div>
                </div>
                
                <button onclick="salvarPerfil()" class="w-full bg-primary text-black font-orbitron font-black uppercase py-4 rounded border-none cursor-pointer hover:brightness-110 transition-all text-lg">
                    SALVAR ALTERA√á√ïES
                </button>
            </div>
        </section>
    </main>

    <!-- Modal de Cotas -->
    <div id="modalCotas" class="modal-overlay">
        <div class="bg-card-bg border border-gray-800 rounded-xl p-8 max-w-2xl w-full relative shadow-2xl">
            <button onclick="fecharModalCotas()" class="absolute top-4 right-6 text-2xl text-gray-400 hover:text-white cursor-pointer transition-colors">
                √ó
            </button>
            
            <h3 class="font-orbitron text-center text-white text-xl mb-8">Quanto mais t√≠tulos, mais chances de ganhar!</h3>
            
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8" id="cotasGrid"></div>
            
            <div class="flex flex-col sm:flex-row gap-6 items-center">
                <div class="flex items-center bg-white rounded-lg p-2 flex-1">
                    <button onclick="adjustQtd(-1)" class="w-12 h-12 border-none bg-transparent text-2xl cursor-pointer font-bold">-</button>
                    <input type="number" id="inputQtd" value="10" min="1" class="w-20 text-2xl font-bold text-center border-none outline-none bg-transparent">
                    <button onclick="adjustQtd(1)" class="w-12 h-12 border-none bg-transparent text-2xl cursor-pointer font-bold">+</button>
                </div>
                
                <button onclick="confirmarAdicaoCarrinho()" class="bg-primary text-black font-rajdhani font-bold rounded-lg py-4 px-8 cursor-pointer hover:brightness-110 transition-all flex-2 w-full sm:w-auto">
                    <span class="block text-sm font-normal">Quero participar</span>
                    <span id="btnTotalValor" class="text-2xl font-black">R$ 0,00</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal PIX -->
    <div id="modalPix" class="modal-overlay">
        <div class="bg-black border-2 border-primary rounded-xl p-10 max-w-lg w-full text-center">
            <h2 class="font-orbitron text-primary text-2xl mb-6">PAGAMENTO PIX</h2>
            
            <p class="text-gray-400 mb-8">Realize a transfer√™ncia para a conta abaixo:</p>
            
            <div class="bg-gray-900 border border-gray-800 rounded-lg p-6 mb-8">
                <div class="mb-6 pb-6 border-b border-gray-800">
                    <label class="font-orbitron text-primary text-xs uppercase block mb-2">TIPO DE CHAVE</label>
                    <span id="txtTipoPix" class="text-white text-xl block">---</span>
                </div>
                
                <div>
                    <label class="font-orbitron text-primary text-xs uppercase block mb-2">CHAVE PIX</label>
                    <div id="txtChavePix" class="text-white text-2xl font-bold break-all">---</div>
                </div>
            </div>
            
            <div class="mt-8 pt-8 border-t border-gray-800">
                <label for="comprovanteInput" class="flex items-center justify-center gap-3 bg-black/50 border border-dashed border-gray-700 rounded-lg p-6 cursor-pointer transition-all hover:border-primary hover:text-primary">
                    <i class="fas fa-paperclip"></i>
                    <span class="font-orbitron text-sm">ANEXAR COMPROVANTE (PDF, PNG, JPG)</span>
                </label>
                <input type="file" id="comprovanteInput" accept="image/png, image/jpeg, image/jpg, application/pdf" class="hidden" onchange="verificarComprovante()">
                <small id="fileNameDisplay" class="text-gray-500 text-sm mt-3 block">Nenhum arquivo selecionado</small>
            </div>
            
            <button id="btnConfirmarPag" class="w-full bg-primary text-black font-orbitron font-bold uppercase py-4 rounded-lg border-none cursor-pointer hover:brightness-110 transition-all mt-8 opacity-50 pointer-events-none">
                J√Å REALIZEI O PAGAMENTO
            </button>
            
            <button onclick="fecharModalPix()" class="w-full bg-transparent border border-gray-700 text-gray-400 font-orbitron uppercase py-4 rounded-lg cursor-pointer hover:border-gray-500 hover:text-gray-300 transition-all mt-4">
                CANCELAR
            </button>
        </div>
    </div>

    <!-- Modal de Vit√≥ria -->
    <div id="modalVictory" class="modal-overlay">
        <div class="bg-black border-2 border-primary rounded-2xl p-12 max-w-xl w-full text-center relative shadow-[0_0_100px_rgba(255,204,0,0.3)] animate-pop-in">
            <span class="text-6xl mb-8 block animate-float">üèÜ</span>
            
            <h1 class="font-orbitron text-primary text-4xl mb-4">PARAB√âNS!</h1>
            <p class="text-white text-xl mb-8">Voc√™ foi sorteado!</p>
            
            <div class="bg-white/10 rounded-xl p-8 mb-8">
                <h2 id="vicItemName" class="text-2xl text-white font-bold mb-2">---</h2>
                <p class="text-gray-300">
                    N√öMERO DA SORTE: <span id="vicNumber" class="text-primary font-bold">---</span>
                </p>
            </div>
            
            <p class="text-gray-400 mb-8">Entre em contato com o suporte ou aguarde nosso contato para o resgate.</p>
            
            <button onclick="fecharNotificacao()" class="bg-primary text-black font-orbitron font-bold uppercase py-4 px-12 rounded-lg border-none cursor-pointer hover:brightness-110 transition-all">
                RECEBER PR√äMIO
            </button>
        </div>
    </div>

    <!-- Modal Detalhes Sorteio -->
    <div id="modalDetails" class="modal-overlay">
        <div class="bg-gray-900 border border-gray-800 rounded-xl p-8 max-w-md w-full">
            <div class="flex justify-between items-center mb-8">
                <h3 class="font-orbitron text-primary text-xl">RESULTADO DO SORTEIO</h3>
                <button onclick="fecharModalDetalhes()" class="text-gray-400 hover:text-white cursor-pointer">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div class="flex justify-between pb-4 border-b border-gray-800">
                    <span class="text-gray-400">ITEM:</span>
                    <strong id="dtItem" class="text-white">---</strong>
                </div>
                
                <div class="flex justify-between pb-4 border-b border-gray-800">
                    <span class="text-gray-400">DATA:</span>
                    <strong id="dtData" class="text-white">---</strong>
                </div>
                
                <div class="flex justify-between pb-4 border-b border-gray-800">
                    <span class="text-gray-400">N√öMERO:</span>
                    <strong id="dtNum" class="text-primary text-2xl">---</strong>
                </div>
                
                <div class="flex justify-between pb-4 border-b border-gray-800">
                    <span class="text-gray-400">GANHADOR:</span>
                    <strong id="dtNome" class="text-white">---</strong>
                </div>
                
                <div class="flex justify-between">
                    <span class="text-gray-400">CPF:</span>
                    <span id="dtCpf" class="text-gray-400">---</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-16 border-t border-gray-900 mt-20">
        <p class="font-orbitron text-gray-500 text-sm">
            COBRIFAS ¬© 2026 - √ÅREA EXCLUSIVA DE MEMBROS.
        </p>
        <p class="text-gray-600 text-xs mt-4">
            Plataforma segura de sorteios de skins de Counter-Strike 2
        </p>
    </footer>

    <script>
        // CONFIGURA√á√ÉO FIREBASE
        const firebaseConfig = {
            "apiKey": "AIzaSyBfX7oMSNn4gSL1Knfx-yvwBwkX4H7JjQg",
            "authDomain": "cobrifas.firebaseapp.com",
            "projectId": "cobrifas",
            "storageBucket": "cobrifas.firebasestorage.app",
            "messagingSenderId": "1098617388770",
            "appId": "1:1098617388770:web:8b6124a9ece62c9f81a8bb"
        };
        
        // Inicializa√ß√£o do Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Vari√°veis globais
        let userAtivo = null;
        let carrinho = [];
        let avatarTemp = "";
        let rifaSelecionadaId = null;
        let precoUnitario = 0;
        let comprovanteAtual = null;

        // Avatares dispon√≠veis
        const avatares = [
            "https://picsum.photos/100?random=1",
            "https://picsum.photos/100?random=2",
            "https://picsum.photos/100?random=3",
            "https://picsum.photos/100?random=4",
            "https://picsum.photos/100?random=5",
            "https://picsum.photos/100?random=6"
        ];

        // Dados de exemplo para demonstra√ß√£o
        const rifasExemplo = [
            {
                "id": "rifa1",
                "nome": "AK-47 Redline",
                "preco": 10.00,
                "total": 1000,
                "vendidas": 750,
                "img": "https://picsum.photos/400/200?random=1"
            },
            {
                "id": "rifa2",
                "nome": "AWP Dragon Lore",
                "preco": 25.00,
                "total": 500,
                "vendidas": 320,
                "img": "https://picsum.photos/400/200?random=2"
            },
            {
                "id": "rifa3",
                "nome": "M4A4 Howl",
                "preco": 15.00,
                "total": 800,
                "vendidas": 450,
                "img": "https://picsum.photos/400/200?random=3"
            },
            {
                "id": "rifa4",
                "nome": "Karambit Fade",
                "preco": 50.00,
                "total": 200,
                "vendidas": 180,
                "img": "https://picsum.photos/400/200?random=4"
            },
            {
                "id": "rifa5",
                "nome": "Desert Eagle Blaze",
                "preco": 5.00,
                "total": 1500,
                "vendidas": 1200,
                "img": "https://picsum.photos/400/200?random=5"
            },
            {
                "id": "rifa6",
                "nome": "Glock-18 Fade",
                "preco": 8.00,
                "total": 1200,
                "vendidas": 950,
                "img": "https://picsum.photos/400/200?random=6"
            }
        ];

        // Fun√ß√£o principal de carregamento
        function carregarDados() {
            // Verificar sess√£o
            const sessao = JSON.parse(localStorage.getItem('sessaoAtiva'));
            if (!sessao) {
                window.location.href = 'index.html';
                return;
            }

            // Simular dados do usu√°rio (para demonstra√ß√£o)
            userAtivo = {
                "nome": "Jo√£o Silva",
                "nick": "joaogamer",
                "cpf": "123.456.789-00",
                "tel": "(11) 99999-9999",
                "avatar": avatares[0],
                "firebaseId": "user123"
            };

            // Atualizar interface do usu√°rio
            atualizarInterfaceUsuario();
            
            // Carregar dados da loja
            carregarLoja();
            
            // Carregar participa√ß√µes
            carregarParticipacoes();
            
            // Carregar avatares
            renderAvatares();
            
            // Carregar rankings
            carregarRankings();
            
            // Configurar ticker
            configurarTicker();
        }

        // Atualizar interface do usu√°rio
        function atualizarInterfaceUsuario() {
            document.getElementById('headName').textContent = userAtivo.nick || userAtivo.nome.split(' ')[0];
            document.getElementById('headAvatar').src = userAtivo.avatar || avatares[0];
            document.getElementById('editNome').value = userAtivo.nome;
            document.getElementById('editNick').value = userAtivo.nick || "";
            document.getElementById('editTel').value = userAtivo.tel || "";
            document.getElementById('dispCpf').value = userAtivo.cpf;
            avatarTemp = userAtivo.avatar || avatares[0];
        }

        // Carregar loja de rifas
        function carregarLoja() {
            const grid = document.getElementById('gridLoja');
            
            grid.innerHTML = rifasExemplo.map(rifa => {
                const percentualVendido = ((rifa.vendidas / rifa.total) * 100).toFixed(1);
                const restantes = rifa.total - rifa.vendidas;
                
                return `
                    <div class="bg-card-bg border border-white/5 rounded-lg p-6 hover:border-primary/30 hover:transform hover:-translate-y-1 transition-all duration-300 relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-primary text-black font-orbitron font-black py-2 px-6 clip-path-polygon">
                            R$ ${rifa.preco.toFixed(2)}
                        </div>
                        
                        <img src="${rifa.img}" alt="${rifa.nome}" class="w-full h-48 object-cover rounded-lg mb-6" loading="lazy">
                        
                        <h3 class="font-orbitron text-xl text-center mb-6">${rifa.nome}</h3>
                        
                        <div class="flex justify-between text-sm text-gray-400 mb-3 font-orbitron">
                            <span>RESTANTES:</span>
                            <span>${restantes}</span>
                        </div>
                        
                        <div class="bg-white/5 h-2 rounded-full overflow-hidden mb-6">
                            <div class="h-full bg-gradient-to-r from-gray-700 to-primary" style="width: ${percentualVendido}%"></div>
                        </div>
                        
                        <button onclick="abrirModalCompra('${rifa.id}', ${rifa.preco}, ${rifa.total}, ${rifa.vendidas})" class="w-full border border-primary text-primary font-orbitron font-black uppercase py-3 rounded bg-transparent cursor-pointer hover:bg-primary hover:text-black transition-all duration-300">
                            PARTICIPAR
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Carregar participa√ß√µes
        function carregarParticipacoes() {
            const container = document.getElementById('listaParticipacoes');
            
            // Dados de exemplo
            const participacoes = [
                {
                    "rifa": "AK-47 Redline",
                    "status": "aprovado",
                    "numeros": [123, 456, 789],
                    "data": "15/03/2024"
                },
                {
                    "rifa": "AWP Dragon Lore",
                    "status": "pendente",
                    "numeros": [],
                    "data": "16/03/2024"
                },
                {
                    "rifa": "M4A4 Howl",
                    "status": "recusado",
                    "numeros": [],
                    "data": "14/03/2024"
                }
            ];
            
            container.innerHTML = participacoes.map(p => {
                const corStatus = p.status === 'aprovado' ? 'success' : p.status === 'recusado' ? 'danger' : 'gray-400';
                const textoStatus = p.status === 'aprovado' ? 'APROVADO' : p.status === 'recusado' ? 'RECUSADO' : 'PENDENTE';
                
                return `
                    <div class="bg-black/30 p-6 rounded-lg border-l-4 border-${corStatus}">
                        <div class="flex justify-between items-center mb-4">
                            <strong class="font-orbitron text-lg">${p.rifa}</strong>
                            <span class="text-${corStatus} font-bold">‚óè ${textoStatus}</span>
                        </div>
                        
                        <div class="bg-black/50 p-4 rounded-lg mt-4">
                            ${p.numeros.length > 0 ? 
                                `<div class="flex flex-wrap gap-2">
                                    ${p.numeros.map(num => `<span class="bg-primary text-black font-orbitron font-black px-3 py-1 rounded text-sm">${num}</span>`).join('')}
                                </div>` :
                                `<p class="text-gray-500 text-sm">Aguardando aprova√ß√£o do pagamento...</p>`
                            }
                        </div>
                        
                        <p class="text-gray-400 text-sm mt-4">Data da compra: ${p.data}</p>
                    </div>
                `;
            }).join('');
        }

        // Carregar rankings
        function carregarRankings() {
            // Ganhadores recentes
            const recentWinners = [
                {"nome": "Jo√£o S.", "skin": "AK-47 Redline", "numero": 456},
                {"nome": "Maria L.", "skin": "AWP Dragon Lore", "numero": 789},
                {"nome": "Carlos M.", "skin": "Karambit Fade", "numero": 123},
                {"nome": "Ana P.", "skin": "M4A4 Howl", "numero": 234},
                {"nome": "Pedro R.", "skin": "Desert Eagle Blaze", "numero": 567}
            ];
            
            const winnersList = document.getElementById('recentWinnersList');
            winnersList.innerHTML = recentWinners.map(winner => `
                <div onclick="verDetalhesSorteio('${winner.skin}')" class="flex justify-between items-center p-4 bg-black/30 rounded-lg cursor-pointer hover:bg-white/5 transition-colors border-l-4 border-success">
                    <div>
                        <span class="font-orbitron text-white">${winner.nome}</span>
                        <p class="text-gray-400 text-sm">${winner.skin}</p>
                    </div>
                    <span class="text-primary font-bold">#${winner.numero}</span>
                </div>
            `).join('');
            
            // Top membros
            const topMembers = [
                {"nome": "GamerPro", "cotas": 156},
                {"nome": "CS2Master", "cotas": 123},
                {"nome": "SkinHunter", "cotas": 98},
                {"nome": "LuckyPlayer", "cotas": 87},
                {"nome": "RifaKing", "cotas": 76}
            ];
            
            const rankingList = document.getElementById('globalRankingList');
            rankingList.innerHTML = topMembers.map((member, index) => {
                const medal = index === 0 ? "ü•á" : index === 1 ? "ü•à" : index === 2 ? "ü•â" : `${index + 1}.`;
                return `
                    <div class="flex justify-between items-center p-4 bg-black/30 rounded-lg">
                        <div class="flex items-center gap-3">
                            <span class="text-xl">${medal}</span>
                            <span class="font-orbitron">${member.nome}</span>
                        </div>
                        <span class="text-primary font-bold">${member.cotas} Cotas</span>
                    </div>
                `;
            }).join('');
        }

        // Configurar ticker
        function configurarTicker() {
            const tickerContainer = document.getElementById('tickerContainer');
            // Conte√∫do j√° est√° no HTML inicial
        }

        // Renderizar avatares
        function renderAvatares() {
            const avatarGrid = document.getElementById('avatarGrid');
            avatarGrid.innerHTML = avatares.map((avatar, index) => `
                <img src="${avatar}" 
                     alt="Avatar ${index + 1}" 
                     class="w-20 h-20 rounded-full object-cover cursor-pointer transition-all duration-300 ${avatarTemp === avatar ? 'border-4 border-primary shadow-[0_0_20px_rgba(255,204,0,0.5)]' : 'border-2 border-gray-700 hover:border-primary'}"
                     onclick="selecionarAvatar('${avatar}')">
            `).join('');
        }

        // Fun√ß√µes de navega√ß√£o
        function openTab(event, tabId) {
            // Remover classe active de todas as tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('[data-tab]').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.remove('text-primary');
                btn.classList.add('text-gray-400');
            });
            
            // Adicionar classe active √† tab selecionada
            const tabElement = document.getElementById(tabId);
            if (tabElement) {
                tabElement.classList.remove('hidden');
                tabElement.classList.add('active');
            }
            
            // Atualizar bot√£o ativo
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
                event.currentTarget.classList.add('text-primary');
                event.currentTarget.classList.remove('text-gray-400');
            } else {
                // Se chamado sem evento, encontrar o bot√£o correspondente
                const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
                if (tabButton) {
                    tabButton.classList.add('active');
                    tabButton.classList.add('text-primary');
                    tabButton.classList.remove('text-gray-400');
                }
            }
        }

        // Fun√ß√µes do carrinho
        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            sidebar.classList.toggle('-translate-x-full');
            
            if (!sidebar.classList.contains('-translate-x-full')) {
                sidebar.style.transform = 'translateX(0)';
            }
        }

        function atualizarCarrinhoUI() {
            const cartList = document.getElementById('cartItemsList');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotalPrice');
            
            let total = 0;
            let count = 0;
            
            cartList.innerHTML = carrinho.map((item, index) => {
                const itemTotal = item.preco * item.qtd;
                total += itemTotal;
                count += item.qtd;
                
                return `
                    <div class="flex justify-between items-center py-4 border-b border-white/5">
                        <div>
                            <p class="font-orbitron">${item.nome}</p>
                            <p class="text-gray-400 text-sm">${item.qtd} √ó R$ ${item.preco.toFixed(2)}</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="text-primary font-bold">R$ ${itemTotal.toFixed(2)}</span>
                            <button onclick="removerDoCarrinho(${index})" class="text-danger hover:text-red-300 cursor-pointer">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            if (carrinho.length === 0) {
                cartList.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-shopping-cart text-4xl text-gray-600 mb-4"></i>
                        <p class="text-gray-500">Seu carrinho est√° vazio</p>
                    </div>
                `;
            }
            
            cartCount.textContent = count;
            cartTotal.textContent = `R$ ${total.toFixed(2)}`;
        }

        function removerDoCarrinho(index) {
            carrinho.splice(index, 1);
            atualizarCarrinhoUI();
        }

        // Fun√ß√µes de modal
        function abrirModalCompra(id, preco, total, vendidas) {
            rifaSelecionadaId = id;
            precoUnitario = preco;
            
            const disponiveis = total - vendidas;
            const cotasGrid = document.getElementById('cotasGrid');
            
            const opcoesCotas = [10, 50, 100, 500, 1000].filter(qtd => qtd <= disponiveis);
            
            cotasGrid.innerHTML = opcoesCotas.map(qtd => `
                <button onclick="setQtd(${qtd})" class="bg-black border border-gray-800 rounded-lg p-6 text-center cursor-pointer hover:border-primary hover:bg-primary/5 transition-all">
                    <span class="font-orbitron text-2xl font-black text-white block">+${qtd}</span>
                    <span class="font-rajdhani text-gray-400 font-bold">R$ ${(qtd * preco).toFixed(2)}</span>
                </button>
            `).join('');
            
            document.getElementById('modalCotas').style.display = 'flex';
            updateTotal();
        }

        function fecharModalCotas() {
            document.getElementById('modalCotas').style.display = 'none';
        }

        function fecharModalPix() {
            document.getElementById('modalPix').style.display = 'none';
        }

        function fecharModalDetalhes() {
            document.getElementById('modalDetails').style.display = 'none';
        }

        function setQtd(qtd) {
            document.getElementById('inputQtd').value = qtd;
            updateTotal();
        }

        function adjustQtd(delta) {
            const input = document.getElementById('inputQtd');
            let valor = parseInt(input.value) + delta;
            if (valor < 1) valor = 1;
            input.value = valor;
            updateTotal();
        }

        function updateTotal() {
            const qtd = parseInt(document.getElementById('inputQtd').value);
            const total = qtd * precoUnitario;
            document.getElementById('btnTotalValor').textContent = `R$ ${total.toFixed(2)}`;
        }

        function confirmarAdicaoCarrinho() {
            const qtd = parseInt(document.getElementById('inputQtd').value);
            
            // Encontrar a rifa selecionada
            const rifa = rifasExemplo.find(r => r.id === rifaSelecionadaId);
            
            if (rifa) {
                carrinho.push({
                    "id": rifaSelecionadaId,
                    "nome": rifa.nome,
                    "preco": precoUnitario,
                    "qtd": qtd
                });
                
                atualizarCarrinhoUI();
                fecharModalCotas();
                toggleCart();
                
                // Notifica√ß√£o
                mostrarNotificacao(`${qtd} cotas de ${rifa.nome} adicionadas ao carrinho!`, 'success');
            }
        }

        function finalizarPedido() {
            if (carrinho.length === 0) {
                mostrarNotificacao('Adicione itens ao carrinho primeiro!', 'danger');
                return;
            }
            
            // Dados PIX de exemplo
            document.getElementById('txtTipoPix').textContent = 'CNPJ';
            document.getElementById('txtChavePix').textContent = '12.345.678/0001-90';
            
            document.getElementById('modalPix').style.display = 'flex';
        }

        function verificarComprovante() {
            const fileInput = document.getElementById('comprovanteInput');
            const fileNameDisplay = document.getElementById('fileNameDisplay');
            const btnConfirmar = document.getElementById('btnConfirmarPag');
            
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                fileNameDisplay.textContent = file.name;
                comprovanteAtual = file.name;
                
                btnConfirmar.classList.remove('opacity-50');
                btnConfirmar.classList.remove('pointer-events-none');
            }
        }

        function confirmarPixReal() {
            if (!comprovanteAtual) {
                mostrarNotificacao('Selecione um comprovante primeiro!', 'danger');
                return;
            }
            
            // Simular envio para o Firebase
            carrinho.forEach(item => {
                console.log(`Pagamento enviado: ${item.qtd} cotas de ${item.nome}`);
            });
            
            // Limpar carrinho
            carrinho = [];
            atualizarCarrinhoUI();
            
            // Fechar modal
            fecharModalPix();
            
            // Mostrar confirma√ß√£o
            mostrarNotificacao('Pagamento enviado para aprova√ß√£o!', 'success');
        }

        // Fun√ß√µes de perfil
        function selecionarAvatar(avatar) {
            avatarTemp = avatar;
            renderAvatares();
        }

        function salvarPerfil() {
            const nome = document.getElementById('editNome').value;
            const nick = document.getElementById('editNick').value;
            const telefone = document.getElementById('editTel').value;
            const senha = document.getElementById('editPass').value;
            const confirmarSenha = document.getElementById('editConfirm').value;
            
            // Valida√ß√µes b√°sicas
            if (!nome.trim()) {
                mostrarNotificacao('Digite seu nome completo!', 'danger');
                return;
            }
            
            if (senha && senha !== confirmarSenha) {
                mostrarNotificacao('As senhas n√£o coincidem!', 'danger');
                return;
            }
            
            // Atualizar dados do usu√°rio
            userAtivo.nome = nome;
            userAtivo.nick = nick;
            userAtivo.tel = telefone;
            userAtivo.avatar = avatarTemp;
            
            // Atualizar interface
            atualizarInterfaceUsuario();
            
            // Simular salvamento no Firebase
            console.log('Perfil salvo:', userAtivo);
            
            mostrarNotificacao('Perfil atualizado com sucesso!', 'success');
        }

        // Fun√ß√µes de suporte
        function enviarMsg() {
            const input = document.getElementById('msgInput');
            const mensagem = input.value.trim();
            
            if (!mensagem) {
                mostrarNotificacao('Digite uma mensagem!', 'danger');
                return;
            }
            
            const chatBox = document.getElementById('chatBox');
            
            // Adicionar mensagem do usu√°rio
            chatBox.innerHTML += `
                <div class="self-end bg-primary text-black p-4 rounded-lg max-w-xs">
                    <p>${mensagem}</p>
                    <p class="text-xs text-gray-800 mt-2">Agora</p>
                </div>
            `;
            
            // Simular resposta autom√°tica
            setTimeout(() => {
                chatBox.innerHTML += `
                    <div class="self-start bg-gray-800 text-white p-4 rounded-lg max-w-xs">
                        <p>Recebemos sua mensagem! Nossa equipe responder√° em breve.</p>
                        <p class="text-xs text-gray-400 mt-2">Suporte COBRIFAS</p>
                    </div>
                `;
                
                // Rolagem autom√°tica
                chatBox.scrollTop = chatBox.scrollHeight;
            }, 1000);
            
            // Limpar input
            input.value = '';
            
            // Rolagem autom√°tica
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // Fun√ß√µes diversas
        function verDetalhesSorteio(skin) {
            // Dados de exemplo
            document.getElementById('dtItem').textContent = skin;
            document.getElementById('dtData').textContent = '15/03/2024 20:30';
            document.getElementById('dtNum').textContent = '#456';
            document.getElementById('dtNome').textContent = 'Jo√£o Silva';
            document.getElementById('dtCpf').textContent = '123.456.789-00';
            
            document.getElementById('modalDetails').style.display = 'flex';
        }

        function fecharNotificacao() {
            document.getElementById('modalVictory').style.display = 'none';
        }

        function logout() {
            localStorage.removeItem('sessaoAtiva');
            window.location.href = 'index.html';
        }

        function mostrarNotificacao(mensagem, tipo) {
            // Criar elemento de notifica√ß√£o
            const notificacao = document.createElement('div');
            notificacao.className = `fixed top-6 right-6 p-4 rounded-lg z-50 font-orbitron animate-slideInRight ${tipo === 'success' ? 'bg-success text-black' : 'bg-danger text-white'}`;
            notificacao.textContent = mensagem;
            
            document.body.appendChild(notificacao);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                notificacao.remove();
            }, 3000);
        }

        // Inicializa√ß√£o
        window.addEventListener('DOMContentLoaded', () => {
            carregarDados();
            
            // Inicializar primeira tab
            openTab(null, 'loja');
            
            // Adicionar estilo para clip-path
            const style = document.createElement('style');
            style.textContent = `
                .clip-path-polygon {
                    clip-path: polygon(10% 0, 100% 0, 100% 100%, 0 100%);
                }
                .pr-full {
                    padding-right: 100%;
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
